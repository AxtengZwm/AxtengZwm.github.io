<!doctype html><html lang=en><head><meta charset=utf-8><meta name=generator content="Hugo 0.83.1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Axteng"><meta property="og:url" content="https://AxtengZwm.github.com/posts/keras-study/"><link rel=canonical href=https://AxtengZwm.github.com/posts/keras-study/><link rel=alternate type=application/atom+xml href=https://AxtengZwm.github.comindex.xml title=学习笔记><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/AxtengZwm.github.com"},"articleSection":"posts","name":"深度学习","headline":"深度学习","description":"机器学习笔记 以服装图形进行分类为例 课程来自https:\/\/tensorflow.google.cn\/tutorials\/keras\/classification\n1.导入相关包 1import tensorflow as tf 2from tensorflow import keras 3 4import numpy as np 5import matplotlib.pyplot as plt 2.导入数据集 1fashion_mnist = keras.datasets.fashion_mnist 2(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data() 3.数据预处理 此数据集中的图片像数值在0-255之间，将这些值缩小至0到1之间，再将其馈送到神经网络模型。\n1train_images = train_images \/ 255.0 2test_images = test_iamges \/ 255.0 4.构建模型  设置层  1model = keras.Sequential([ 2keras.layers.Flatten(input_shape(28,28)),#将图像格式从二维数组（28*28）转换为一维数组784 3keras.layers.Dense(128, activation=\u0026#39;relu\u0026#39;),#Dense表示全连接层，128个节点，激活函数为relu 4keras.layers.Dense(10)#10个节点，代表本数据集中的十种分类 5 ]) 编译模型  1model.compile(optimizer = \u0026#39;adam\u0026#39;),#优化器 2loss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits = True),#损失函数 3metrics = [\u0026#39;accuracy\u0026#39;]#指标，此处使用的是准确率，即分类正确比率 训练模型  1model.","inLanguage":"en-US","author":"Axteng","creator":"Axteng","publisher":"Axteng","accountablePerson":"Axteng","copyrightHolder":"Axteng","copyrightYear":"2020","datePublished":"2020-09-24 09:20:11 \u002b0800 \u002b0800","dateModified":"2020-09-24 09:20:11 \u002b0800 \u002b0800","url":"https:\/\/AxtengZwm.github.com\/posts\/keras-study\/","keywords":[]}</script><title>深度学习 - 学习笔记</title><meta property="og:title" content="深度学习 - 学习笔记"><meta property="og:type" content="article"><meta property="og:description" content="机器学习笔记 以服装图形进行分类为例 课程来自https://tensorflow.google.cn/tutorials/keras/classification
1.导入相关包 1import tensorflow as tf 2from tensorflow import keras 3 4import numpy as np 5import matplotlib.pyplot as plt 2.导入数据集 1fashion_mnist = keras.datasets.fashion_mnist 2(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data() 3.数据预处理 此数据集中的图片像数值在0-255之间，将这些值缩小至0到1之间，再将其馈送到神经网络模型。
1train_images = train_images / 255.0 2test_images = test_iamges / 255.0 4.构建模型  设置层  1model = keras.Sequential([ 2keras.layers.Flatten(input_shape(28,28)),#将图像格式从二维数组（28*28）转换为一维数组784 3keras.layers.Dense(128, activation='relu'),#Dense表示全连接层，128个节点，激活函数为relu 4keras.layers.Dense(10)#10个节点，代表本数据集中的十种分类 5 ]) 编译模型  1model.compile(optimizer = 'adam'),#优化器 2loss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits = True),#损失函数 3metrics = ['accuracy']#指标，此处使用的是准确率，即分类正确比率 训练模型  1model."><meta name=description content="机器学习笔记 以服装图形进行分类为例 课程来自https://tensorflow.google.cn/tutorials/keras/classification
1.导入相关包 1import tensorflow as tf 2from tensorflow import keras 3 4import numpy as np 5import matplotlib.pyplot as plt 2.导入数据集 1fashion_mnist = keras.datasets.fashion_mnist 2(train_images, train_labels), (test_images, test_labels) = fashion_mnist.load_data() 3.数据预处理 此数据集中的图片像数值在0-255之间，将这些值缩小至0到1之间，再将其馈送到神经网络模型。
1train_images = train_images / 255.0 2test_images = test_iamges / 255.0 4.构建模型  设置层  1model = keras.Sequential([ 2keras.layers.Flatten(input_shape(28,28)),#将图像格式从二维数组（28*28）转换为一维数组784 3keras.layers.Dense(128, activation='relu'),#Dense表示全连接层，128个节点，激活函数为relu 4keras.layers.Dense(10)#10个节点，代表本数据集中的十种分类 5 ]) 编译模型  1model.compile(optimizer = 'adam'),#优化器 2loss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits = True),#损失函数 3metrics = ['accuracy']#指标，此处使用的是准确率，即分类正确比率 训练模型  1model."><meta property="og:locale" content="zh-cn"><link rel=stylesheet href=/css/flexboxgrid-6.3.1.min.css><link rel=stylesheet href=/css/github-markdown.css><link rel=stylesheet href=/css/highlight/tomorrow.min.css><link rel=stylesheet href=/css/index.css><link href=/index.xml rel=alternate type=application/rss+xml title=学习笔记><link href="https://fonts.googleapis.com/css?family=Arvo|Permanent+Marker|Bree+Serif" rel=stylesheet></head><body><article class="post Chinese" id=article><div class=row><div class=col-xs-12><div class=site-header><header><div class="signatures site-title"><a href=/>Axteng</a></div></header><div class="row end-xs"></div><div class=header-line></div></div><header class=post-header><h1 class=post-title>深度学习</h1><div class="row post-desc"><div class=col-xs-6><time class=post-date datetime="2020-09-24 09:20:11 +0800">2020.09.24</time></div><div class=col-xs-6><div class=post-author><a target=_blank href=https://github.com/AxtengZwm/>@Axteng</a></div></div></div></header><div class="post-content markdown-body"><h1 id=机器学习笔记>机器学习笔记</h1><h3 id=以服装图形进行分类为例>以服装图形进行分类为例</h3><p>课程来自<a href=https://tensorflow.google.cn/tutorials/keras/classification>https://tensorflow.google.cn/tutorials/keras/classification</a></p><h2 id=1导入相关包>1.导入相关包</h2><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=kn>import</span> <span class=nn>tensorflow</span> <span class=kn>as</span> <span class=nn>tf</span>
<span class=ln>2</span><span class=kn>from</span> <span class=nn>tensorflow</span> <span class=kn>import</span> <span class=n>keras</span>
<span class=ln>3</span>
<span class=ln>4</span><span class=kn>import</span> <span class=nn>numpy</span> <span class=kn>as</span> <span class=nn>np</span>
<span class=ln>5</span><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=kn>as</span> <span class=nn>plt</span>
</code></pre></div><h2 id=2导入数据集>2.导入数据集</h2><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=n>fashion_mnist</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>datasets</span><span class=o>.</span><span class=n>fashion_mnist</span>
<span class=ln>2</span><span class=p>(</span><span class=n>train_images</span><span class=p>,</span> <span class=n>train_labels</span><span class=p>),</span> <span class=p>(</span><span class=n>test_images</span><span class=p>,</span> <span class=n>test_labels</span><span class=p>)</span> <span class=o>=</span> <span class=n>fashion_mnist</span><span class=o>.</span><span class=n>load_data</span><span class=p>()</span>
</code></pre></div><h2 id=3数据预处理>3.数据预处理</h2><p>此数据集中的图片像数值在0-255之间，将这些值缩小至0到1之间，再将其馈送到神经网络模型。</p><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=n>train_images</span> <span class=o>=</span> <span class=n>train_images</span> <span class=o>/</span> <span class=mf>255.0</span>
<span class=ln>2</span><span class=n>test_images</span> <span class=o>=</span> <span class=n>test_iamges</span> <span class=o>/</span> <span class=mf>255.0</span>
</code></pre></div><h2 id=4构建模型>4.构建模型</h2><ol><li>设置层</li></ol><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=n>model</span> <span class=o>=</span> <span class=n>keras</span><span class=o>.</span><span class=n>Sequential</span><span class=p>([</span>
<span class=ln>2</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Flatten</span><span class=p>(</span><span class=n>input_shape</span><span class=p>(</span><span class=mi>28</span><span class=p>,</span><span class=mi>28</span><span class=p>)),</span><span class=c1>#将图像格式从二维数组（28*28）转换为一维数组784</span>
<span class=ln>3</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>128</span><span class=p>,</span> <span class=n>activation</span><span class=o>=</span><span class=s1>&#39;relu&#39;</span><span class=p>),</span><span class=c1>#Dense表示全连接层，128个节点，激活函数为relu</span>
<span class=ln>4</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span><span class=c1>#10个节点，代表本数据集中的十种分类</span>
<span class=ln>5</span>    <span class=p>])</span>
</code></pre></div><ol start=2><li>编译模型</li></ol><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=n>model</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=n>optimizer</span> <span class=o>=</span> <span class=s1>&#39;adam&#39;</span><span class=p>),</span><span class=c1>#优化器</span>
<span class=ln>2</span><span class=n>loss</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>losses</span><span class=o>.</span><span class=n>SparseCategoricalCrossentropy</span><span class=p>(</span><span class=n>from_logits</span> <span class=o>=</span> <span class=bp>True</span><span class=p>),</span><span class=c1>#损失函数</span>
<span class=ln>3</span><span class=n>metrics</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;accuracy&#39;</span><span class=p>]</span><span class=c1>#指标，此处使用的是准确率，即分类正确比率</span>
</code></pre></div><ol start=3><li>训练模型</li></ol><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=n>model</span><span class=o>.</span><span class=n>fit</span><span class=p>(</span><span class=n>train_images</span><span class=p>,</span> <span class=n>train_labels</span><span class=p>,</span> <span class=n>epochs</span> <span class=o>=</span> <span class=mi>10</span><span class=p>)</span>
</code></pre></div><ol start=4><li>评估准确率</li></ol><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=n>test_loss</span><span class=p>,</span> <span class=n>test_acc</span> <span class=o>=</span> <span class=n>model</span><span class=o>.</span><span class=n>evaluate</span><span class=p>(</span><span class=n>test_images</span><span class=p>,</span> <span class=n>test_labels</span><span class=p>,</span> <span class=n>verbose</span> <span class=o>=</span> <span class=mi>2</span><span class=p>)</span>
</code></pre></div><ol start=5><li>进行预测</li></ol><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=n>probability_model</span> <span class=o>=</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>Sequential</span><span class=p>([</span><span class=n>model</span><span class=p>,</span> <span class=n>tf</span><span class=o>.</span><span class=n>keras</span><span class=o>.</span><span class=n>layers</span><span class=o>.</span><span class=n>Softmax</span><span class=p>()])</span><span class=c1>#已经具有线性输出，在此基础上附加一个softmax层，将其转换为概率</span>
<span class=ln>2</span><span class=n>predcitions</span> <span class=o>=</span> <span class=n>probability_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>test_images</span><span class=p>)</span>
<span class=ln>3</span><span class=n>predictions</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=c1>#输出概率数组</span>
<span class=ln>4</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>predictions</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</code></pre></div><ol start=6><li>使用预测好的模型</li></ol><div class=highlight><pre class=chroma><code class=language-python data-lang=python><span class=ln>1</span><span class=n>img</span> <span class=o>=</span> <span class=n>test_iamges</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
<span class=ln>2</span><span class=k>print</span><span class=p>(</span><span class=n>img</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span><span class=c1>#输出（28，28）</span>
<span class=ln>3</span><span class=n>img</span> <span class=o>=</span> <span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>expand_dims</span><span class=p>(</span><span class=n>img</span><span class=p>,</span><span class=mi>0</span><span class=p>))</span>
<span class=ln>4</span><span class=k>print</span><span class=p>(</span><span class=n>img</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span><span class=c1>#输出（1，28，28）增加维度</span>
<span class=ln>5</span><span class=n>predictions_single</span> <span class=o>=</span> <span class=n>probability_model</span><span class=o>.</span><span class=n>predict</span><span class=p>(</span><span class=n>img</span><span class=p>)</span>
<span class=ln>6</span><span class=k>print</span><span class=p>(</span><span class=n>predictions_single</span><span class=p>)</span>
<span class=ln>7</span><span class=n>np</span><span class=o>.</span><span class=n>argmax</span><span class=p>(</span><span class=n>predictions_single</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</code></pre></div></div><div class="row middle-xs"><div class=col-xs-12><div class=post-category><a href=/categories/dlearn>DLearn</a></div></div></div><div class=row><div class=col-xs-12></div></div><div style=height:50px></div><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js></script><div class=site-footer><div class=site-footer-item><a href=https://github.com/AxtengZwm/ target=_blank>Github</a></div><div class=site-footer-item><a href=mailto:AxtengZwm@google.com target=_blank>Mail</a></div></div></div></div></article><script src=/js/highlight.pack.js></script><script src=/js/lazyload.min.js></script><script>var lazyImage=new LazyLoad({container:document.getElementById('article')})</script><script>hljs.initHighlightingOnLoad()</script></body></html>